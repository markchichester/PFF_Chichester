<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ACC Defenses: EPA allowed per pass, EPA allowed per run</title>
    <link href="https://fonts.googleapis.com/css2?family=Archivo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Archivo', sans-serif;
            background: #ffffff;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
        }
        h3 {
            margin: 10px 0;
            color: #333;
            font-weight: 700;
            text-align: center;
            font-size: clamp(16px, 2.5vw, 24px);
        }
        .chart-container {
            width: 100%;
            max-width: 600px;
            aspect-ratio: 4 / 3;
            position: relative;
            background: #ffffff;
        }
        svg {
            width: 100%;
            height: 100%;
        }
        .dot {
            fill: gray;
            stroke: #333;
            stroke-width: 1;
            cursor: pointer;
            transition: opacity 0.3s ease;
        }
        .dot.alabama {
            fill: #9c1831;
        }
        .logo {
            position: absolute;
            width: 40px;
            height: 40px;
            opacity: 0;
            pointer-events: none;
            transform: translate(-50%, -50%);
            transition: opacity 0.3s ease, transform 0.3s ease;
        }
        .logo.active {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1.1);
        }
        .tooltip {
            position: absolute;
            background: #ffffff;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            padding: 10px;
            font-size: 14px;
            line-height: 1.5;
            color: #333;
            pointer-events: none;
            opacity: 0;
            width: 190px;
            text-align: center;
            z-index: 10;
            transition: opacity 0.2s ease;
        }
        .avg-line {
            stroke: rgba(255,0,0,0.3);
            stroke-width: 1.5;
            stroke-dasharray: 5,5;
        }
        .grid-line {
            stroke: #e0e0e0;
            stroke-width: 1;
        }
        .tick-label {
            fill: #666;
            font-size: clamp(10px, 1.5vw, 12px);
        }
        .axis-title {
            fill: #666;
            font-size: clamp(10px, 1.5vw, 14px);
            text-anchor: middle;
        }
    .dot.highlight {
    fill: #DE3121;
}
.dot.highlight {
    fill: #F66733;
}
</style>
</head>
<body>
    <h3>ACC Defenses: EPA allowed per pass, EPA allowed per run</h3>
    <div class="chart-container" id="chartContainer">
        <svg id="defenseChart"></svg>
        <div class="tooltip" id="tooltip"></div>
    </div>
<script>
    const data = [
    {
        "name": "Boston College Eagles",
        "x": -0.131263158,
        "y": -0.044426415,
        "logo": "http://a.espncdn.com/i/teamlogos/ncaa/500/103.png",
        "highlight": false
    },
    {
        "name": "California Golden Bears",
        "x": -0.114675749,
        "y": -0.037083942,
        "logo": "http://a.espncdn.com/i/teamlogos/ncaa/500/25.png",
        "highlight": false
    },
    {
        "name": "Clemson Tigers",
        "x": -0.002149758,
        "y": -0.100278547,
        "logo": "http://a.espncdn.com/i/teamlogos/ncaa/500/228.png",
        "highlight": true
    },
    {
        "name": "Duke Blue Devils",
        "x": -0.096383178,
        "y": -0.141856884,
        "logo": "http://a.espncdn.com/i/teamlogos/ncaa/500/150.png",
        "highlight": false
    },
    {
        "name": "Florida State Seminoles",
        "x": 0.017972093,
        "y": 0.167871605,
        "logo": "http://a.espncdn.com/i/teamlogos/ncaa/500/52.png",
        "highlight": false
    },
    {
        "name": "Georgia Tech Yellow Jackets",
        "x": -0.111354167,
        "y": 0.089658635,
        "logo": "http://a.espncdn.com/i/teamlogos/ncaa/500/59.png",
        "highlight": false
    },
    {
        "name": "Louisville Cardinals",
        "x": -0.134809019,
        "y": 0.024294333,
        "logo": "http://a.espncdn.com/i/teamlogos/ncaa/500/97.png",
        "highlight": false
    },
    {
        "name": "Miami Fl Hurricanes",
        "x": -0.101705882,
        "y": 0.005211946,
        "logo": "http://a.espncdn.com/i/teamlogos/ncaa/500/2390.png",
        "highlight": false
    },
    {
        "name": "North Carolina Tar Heels",
        "x": -0.038298368,
        "y": 0.038995842,
        "logo": "http://a.espncdn.com/i/teamlogos/ncaa/500/153.png",
        "highlight": false
    },
    {
        "name": "North Carolina State Wolfpack",
        "x": 0.023320755,
        "y": 0.020960317,
        "logo": "http://a.espncdn.com/i/teamlogos/ncaa/500/152.png",
        "highlight": false
    },
    {
        "name": "Pittsburgh Panthers",
        "x": -0.134436451,
        "y": 0.018941379,
        "logo": "http://a.espncdn.com/i/teamlogos/ncaa/500/221.png",
        "highlight": false
    },
    {
        "name": "Smu Mustangs",
        "x": -0.220338235,
        "y": -0.124714521,
        "logo": "http://a.espncdn.com/i/teamlogos/ncaa/500/2567.png",
        "highlight": false
    },
    {
        "name": "Stanford Cardinal",
        "x": 0.015716923,
        "y": 0.155640244,
        "logo": "http://a.espncdn.com/i/teamlogos/ncaa/500/24.png",
        "highlight": false
    },
    {
        "name": "Syracuse Orange",
        "x": -0.013469388,
        "y": 0.103799189,
        "logo": "http://a.espncdn.com/i/teamlogos/ncaa/500/183.png",
        "highlight": false
    },
    {
        "name": "Virginia Cavaliers",
        "x": 0.019517333,
        "y": 0.062048729,
        "logo": "http://a.espncdn.com/i/teamlogos/ncaa/500/258.png",
        "highlight": false
    },
    {
        "name": "Virginia Tech Hokies",
        "x": -0.103154791,
        "y": -0.066954455,
        "logo": "http://a.espncdn.com/i/teamlogos/ncaa/500/259.png",
        "highlight": false
    },
    {
        "name": "Wake Forest Demon Deacons",
        "x": 0.081448649,
        "y": 0.101325714,
        "logo": "http://a.espncdn.com/i/teamlogos/ncaa/500/154.png",
        "highlight": false
    }
];

    const container = document.getElementById("chartContainer");
    const svg = document.getElementById("defenseChart");
    const tooltip = document.getElementById("tooltip");
    const width = svg.clientWidth;
    const height = svg.clientHeight;
    const padding = {top: 20, right: 20, bottom: 40, left: 50};

    const xMin = Math.min(...data.map(d => d.x)) - 0.01;
    const xMax = Math.max(...data.map(d => d.x)) + 0.01;
    const yMin = Math.min(...data.map(d => d.y)) - 0.01;
    const yMax = Math.max(...data.map(d => d.y)) + 0.01;

    const avgX = data.reduce((sum, d) => sum + d.x, 0) / data.length;
    const avgY = data.reduce((sum, d) => sum + d.y, 0) / data.length;

    function scaleX(x) {
        return padding.left + ((x - xMin) / (xMax - xMin)) * (width - padding.left - padding.right);
    }
    function scaleY(y) {
        return height - padding.bottom - ((y - yMin) / (yMax - yMin)) * (height - padding.top - padding.bottom);
    }

    const ns = "http://www.w3.org/2000/svg";
    function addLine(x1, y1, x2, y2, cls) {
        const line = document.createElementNS(ns, "line");
        line.setAttribute("x1", x1);
        line.setAttribute("y1", y1);
        line.setAttribute("x2", x2);
        line.setAttribute("y2", y2);
        line.setAttribute("class", cls);
        svg.appendChild(line);
    }

    function addText(x, y, textContent, cls) {
        const text = document.createElementNS(ns, "text");
        text.setAttribute("x", x);
        text.setAttribute("y", y);
        text.setAttribute("class", cls);
        text.textContent = textContent;
        svg.appendChild(text);
    }

    // Gridlines & Ticks
    const numTicks = 5;
    for (let i = 0; i <= numTicks; i++) {
        const xValue = xMin + (i / numTicks) * (xMax - xMin);
        const xPos = scaleX(xValue);
        addLine(xPos, padding.top, xPos, height - padding.bottom, "grid-line");
        addText(xPos, height - padding.bottom + 15, xValue.toFixed(2), "tick-label");

        const yValue = yMin + (i / numTicks) * (yMax - yMin);
        const yPos = scaleY(yValue);
        addLine(padding.left, yPos, width - padding.right, yPos, "grid-line");
        addText(padding.left - 10, yPos + 4, yValue.toFixed(2), "tick-label");
    }

    // Average Lines
    addLine(scaleX(avgX), padding.top, scaleX(avgX), height - padding.bottom, "avg-line");
    addLine(padding.left, scaleY(avgY), width - padding.right, scaleY(avgY), "avg-line");

    // Axis Titles
    addText(width / 2, height - 10, "EPA allowed per run", "axis-title");
    const yAxisTitle = document.createElementNS(ns, "text");
    yAxisTitle.setAttribute("x", -height / 2);
    yAxisTitle.setAttribute("y", 15);
    yAxisTitle.setAttribute("transform", "rotate(-90)");
    yAxisTitle.setAttribute("class", "axis-title");
    yAxisTitle.textContent = "EPA allowed per pass";
    svg.appendChild(yAxisTitle);

    // Dots & Logos
    const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;

data.forEach((d, i) => {
    const circle = document.createElementNS(ns, "circle");
    circle.setAttribute("cx", scaleX(d.x));
    circle.setAttribute("cy", scaleY(d.y));
    circle.setAttribute("r", 5);
    circle.setAttribute("class", `dot ${d.highlight ? "highlight" : ""}`);
    svg.appendChild(circle);

    const img = document.createElement("img");
    img.src = d.logo;
    img.className = "logo";
    img.style.left = `${scaleX(d.x)}px`;
    img.style.top = `${scaleY(d.y)}px`;
    container.appendChild(img);

    if (isTouchDevice) {
        // Tap Support for Mobile
        circle.addEventListener('click', () => {
            container.querySelectorAll('.logo').forEach(el => el.classList.remove('active'));
            container.querySelectorAll('.dot').forEach(el => el.style.opacity = 1);
            tooltip.style.opacity = 0;

            const isActive = img.classList.contains('active');
            if (!isActive) {
                circle.style.opacity = 0;
                img.classList.add('active');
                tooltip.innerHTML = `<strong>${d.name}</strong><br>EPA allowed per pass: ${d.y.toFixed(3)}<br>EPA allowed per run: ${d.x.toFixed(3)}`;
                tooltip.style.opacity = 1;

                const rect = container.getBoundingClientRect();
                const tooltipX = scaleX(d.x) - tooltip.offsetWidth / 2;
                const tooltipY = scaleY(d.y) + 35;
                tooltip.style.left = `${Math.max(0, Math.min(tooltipX, rect.width - tooltip.offsetWidth))}px`;
                tooltip.style.top = `${tooltipY}px`;
            } else {
                img.classList.remove('active');
                circle.style.opacity = 1;
                tooltip.style.opacity = 0;
            }
        });
    } else {
        // Hover Support for Desktop
        circle.addEventListener('mouseenter', () => {
            circle.style.opacity = 0;
            img.classList.add('active');
            tooltip.innerHTML = `<strong>${d.name}</strong><br>EPA allowed per pass: ${d.y.toFixed(3)}<br>EPA allowed per run: ${d.x.toFixed(3)}`;
            tooltip.style.opacity = 1;

            const rect = container.getBoundingClientRect();
            const tooltipX = scaleX(d.x) - tooltip.offsetWidth / 2;
            const tooltipY = scaleY(d.y) + 35;
            tooltip.style.left = `${Math.max(0, Math.min(tooltipX, rect.width - tooltip.offsetWidth))}px`;
            tooltip.style.top = `${tooltipY}px`;
        });
        circle.addEventListener('mouseleave', () => {
            circle.style.opacity = 1;
            img.classList.remove('active');
            tooltip.style.opacity = 0;
        });
    }
});

// ðŸ‘‡ Add global tap-out listener for mobile
if (isTouchDevice) {
    document.addEventListener('click', function(event) {
        const clickedInside = container.contains(event.target);
        if (!clickedInside) {
            container.querySelectorAll('.logo').forEach(el => el.classList.remove('active'));
            container.querySelectorAll('.dot').forEach(el => el.style.opacity = 1);
            tooltip.style.opacity = 0;
        }
    });
}

</script>
</body>
</html>